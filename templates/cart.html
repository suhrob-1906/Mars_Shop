{% extends "base.html" %}
{% load static %}
{% block content %}

<section class="container mx-auto px-4 py-12">

    <h2 class="text-4xl text-center text-orange-600 font-bold mb-8">Корзина</h2>

    {% if items %}
        {% static 'images/placeholder.png' as placeholder_img %}
        <div class="space-y-4">
            {% for item in items %}
                <div class="bg-white p-5 rounded-xl border border-orange-100 shadow-sm flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <img src="{{ item.product.photo_url|default:placeholder_img }}"
                             alt="{{ item.product.name }}"
                             class="h-20 w-20 object-cover rounded-lg border border-slate-200">
                        <div>
                            <h3 class="text-xl text-slate-800 font-semibold">{{ item.product.name }}</h3>
                            <p class="text-slate-500">
                                Количество:
                                <span id="qty-{{ item.id }}">{{ item.quantity }}</span>
                            </p>
                        </div>
                    </div>

                    <div class="flex items-center gap-4">
                        <span class="text-2xl font-bold text-orange-500">{{ item.total_price }} ₽</span>

                        <div class="flex items-center gap-2">
                            <button type="button"
                                    onclick="changeQty({{ item.id }}, 'decrease')"
                                    class="px-3 py-1 bg-slate-100 text-slate-800 rounded hover:bg-slate-200 border border-slate-300">
                                -
                            </button>
                            <button type="button"
                                    onclick="changeQty({{ item.id }}, 'increase')"
                                    class="px-3 py-1 bg-slate-100 text-slate-800 rounded hover:bg-slate-200 border border-slate-300">
                                +
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="mt-8 text-right text-3xl text-orange-500 font-bold">
            Итого: <span id="cart-total">{{ cart_total }}</span> ₽
        </div>

        <div class="mt-6 flex flex-col sm:flex-row justify-end gap-4">
            <button type="button"
                    onclick="clearCart()"
                    class="btn-primary btn-red">
                Очистить корзину
            </button>
            <button type="button"
                    onclick="checkout()"
                    class="btn-primary btn-green">
                Оформить заказ
            </button>
        </div>

    {% else %}
        <p class="text-center text-slate-500 text-xl">Корзина пуста</p>
    {% endif %}
</section>

{% endblock %}

{% block scripts %}
<script src="{% static 'js/cart.js' %}"></script>
{% endblock %}
