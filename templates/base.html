{% load static %}
<!doctype html>
<html lang="ru" class="theme-light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Mars Shop ‚Äî {{ title|default:"–õ—É—á—à–∏–µ —Ç–æ–≤–∞—Ä—ã —Å –ú–∞—Ä—Å–∞" }}</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom CSS (–ª–µ–∂–∏—Ç –≤ static/js/mars.css) -->
    <link rel="preload" href="{% static 'js/mars.css' %}" as="style">
    <link rel="stylesheet" href="{% static 'js/mars.css' %}">

    {% block head_extra %}{% endblock %}
</head>

<body class="bg-white text-gray-900 transition-colors duration-300">

<!-- ===== HEADER ===== -->
<header class="w-full shadow bg-white sticky top-0 z-40 border-b border-gray-200">
    <div class="container mx-auto px-4 py-4 flex items-center justify-between">

        <!-- LOGO TEXT -->
        <a href="{% url 'index' %}" class="font-extrabold text-3xl tracking-wide text-orange-600 hover:text-orange-700 transition">
            Mars Shop
        </a>

        <!-- SEARCH -->
        <form action="{% url 'index' %}" method="get" class="hidden md:block w-1/3">
            <input
                type="text"
                name="q"
                placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..."
                class="w-full px-4 py-2 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white text-gray-800"
                value="{{ request.GET.q }}"
            >
        </form>

        <!-- NAV -->
        <nav class="flex items-center gap-6 text-lg">

            <a href="{% url 'index' %}" class="hover:text-orange-600 transition">
                –ì–ª–∞–≤–Ω–∞—è
            </a>

            <!-- CART -->
            <a href="{% url 'cart' %}" class="relative hover:text-orange-600 transition flex items-center gap-2">
                <span>üõí</span>
                {% if cart_count %}
                <span class="absolute -top-2 -right-3 bg-red-600 text-white text-xs rounded-full px-2 py-0.5 shadow">
                    {{ cart_count }}
                </span>
                {% endif %}
            </a>

            <!-- USER -->
            {% if user.is_authenticated %}
                <span class="opacity-80 flex items-center gap-1">
                    üë§ {{ user.username }}
                </span>
                <a href="{% url 'logout' %}"
                   class="px-3 py-1 rounded-xl border border-red-400 text-red-600 hover:bg-red-50 transition">
                    –í—ã–π—Ç–∏
                </a>
            {% else %}
                <a href="{% url 'login' %}"
                   class="px-3 py-1 rounded-xl border border-orange-400 text-orange-600 hover:bg-orange-50 transition">
                    –í–æ–π—Ç–∏
                </a>
            {% endif %}

            <!-- THEME SWITCH -->
            <button id="themeToggle"
                class="text-2xl ml-3 hover:text-orange-600 transition"
                title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">
                üåû
            </button>

        </nav>
    </div>
</header>

<!-- ===== MAIN CONTENT ===== -->
<main class="flex-1">
    {% block content %}{% endblock %}
</main>

<!-- ===== FOOTER ===== -->
<footer class="mt-20 py-10 bg-gray-100 border-t border-gray-300 text-center text-gray-700 transition-colors duration-300">
    <h3 class="text-xl mb-3 font-semibold text-orange-600">Mars Shop</h3>
    <p class="opacity-90 mb-2">–ú–∞–≥–∞–∑–∏–Ω –±—É–¥—É—â–µ–≥–æ ‚Äî —Å–∞–º–∞—è —Å–≤–µ—Ç–ª–∞—è –≤–µ—Ä—Å–∏—è üåû</p>

    <div class="flex justify-center gap-6 mt-3">
        <a href="https://t.me/your_bot_here"
           class="text-orange-600 hover:underline">–ù–∞—à Telegram –±–æ—Ç</a>
        <a href="https://maps.app.goo.gl/your_place_here"
           class="text-orange-600 hover:underline">–õ–æ–∫–∞—Ü–∏—è –º–∞–≥–∞–∑–∏–Ω–∞</a>
    </div>

    <p class="mt-4 text-xs opacity-60">
        Mars ¬© –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã
    </p>
</footer>

<!-- THEME TOGGLER SCRIPT (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π) -->
<script>
(function() {
    const html = document.documentElement;
    const btn = document.getElementById("themeToggle");
    if (!btn) return;

    function applyTheme(theme) {
        html.classList.remove("theme-light", "theme-dark");
        if (theme === "dark") {
            html.classList.add("theme-dark");
            btn.textContent = "üåô";
        } else {
            html.classList.add("theme-light");
            btn.textContent = "üåû";
        }
        localStorage.setItem("theme", theme);
    }

    // –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π —Ç–µ–º—ã
    const saved = localStorage.getItem("theme");
    if (saved === "dark") {
        applyTheme("dark");
    } else {
        applyTheme("light"); // —Å–≤–µ—Ç–ª–∞—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    }

    btn.addEventListener("click", () => {
        const isDark = html.classList.contains("theme-dark");
        applyTheme(isDark ? "light" : "dark");
    });
})();
</script>

{% block scripts %}{% endblock %}
</body>
</html>
